---
tags: meeting
---

Meeting Tesi 2021-03-22
===

:::info
- **Location:** Skype
- **Date:** 2021-03-22
- **Agenda**
    1. Timely Dataflow: main differences
- **Participants:**
    - Alessandro Margara (AM)
    - Gianpaolo Cugola (GC)
    - Marco Donadoni (MD)
    - Edoardo Morassutto (EM)

:::

## [Timely Dataflow](https://timelydataflow.github.io/timely-dataflow/introduction.html): main differences


- All the graph definition is inside a closure: much easier to spawn threads
- Cooperative multitasking:
    - Operators of each block are executed one after the other, non-preemptively
    - Each operator is replicated as many times as threads
    - Data inside the same thread use `VecDeque` and not channels to send data
    - The operator may produce some output and this marks its successors as _schedulable_ and they will be immediately scheduled inside the same step
- It avoid everywhere possible to move memory:
    - Share data and use `std::mem::swap`
    - Avoid copying and dropping almost everything
- Capabilities:
    - If an operator wants to send a message with a given timestamp, it has to have the proper capability
    - Dropping (or downgrading) a capability is equivalent of sending a watermark: the operator will never be able to send any message with timestamp less or equal to that capability (without having other capabilities stored)
    - Capabilities are not optional
    - Operators have an initial capability (i.e. timestamp zero), and a capability for each incoming message
        - The initial one is used to send messages before receiving any
    - Batches are tagged with timestamps, not single messages
- Writing custom operators is easy, the ones provided are very few
    - There aren't windows of any sort
    - There isn't the reduce operator (or any aggregation operator)
- Special _probe_ operators can be used to track the progress of the computation signaling when a "watermark" passes
- Messages are serialized with either `bincode` or `abomonation` (defaults to `abomonation`)

Notes from [the paper](https://dl.acm.org/doi/pdf/10.1145/2517349.2522738) to fact-check from the code:

- Nagle's algorithm is disabled reducing the latency for small messages (usually present in the last steps of the computation)
    - True
- Fault tolerance is implemented
    - False [#102](https://github.com/TimelyDataflow/timely-dataflow/issues/102)